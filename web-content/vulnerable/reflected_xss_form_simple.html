<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ã€ãƒ†ãƒ¼ãƒ 2ã€‘åå°„å‹ XSS (document.writeç‰ˆ)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .payload-box {
            margin-top: 20px;
            padding: 10px;
            border: 1px dashed #007bff;
            background-color: #e6f7ff;
        }
        pre {
            background-color: #fff; 
            padding: 5px; 
            border: 1px solid #ddd; 
            overflow-x: auto;
            white-space: pre-wrap; /* é•·ã„ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§ã‚‚æŠ˜ã‚Šè¿”ã—ã‚’å¯èƒ½ã«ã™ã‚‹ */
        }
        .warning { color: #c00; }
    </style>
</head>
<body>
    <h1>ğŸ” åå°„å‹ XSS æ¤œè¨¼ãƒšãƒ¼ã‚¸ (document.writeç‰ˆ)</h1>

    <form action="reflected_xss_form_simple.html" method="GET">
        <label for="query">ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å…¥åŠ›:</label>
        <input type="text" name="q" size="60" required>
        <button type="submit">é€ä¿¡</button>
    </form>
    
    <div class="payload-box">
        <strong>ğŸ’¡ æ¤œè¨¼ç”¨ XSS ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ä¾‹ï¼š</strong>
        <pre>
1. &lt;script&gt;alert('Hello!')&lt;/script&gt;
2. &lt;img src=x onerror=alert('XSSæˆåŠŸï¼')&gt;</pre>
        <p class="warning">
            â€» 1ç•ªç›®ã®ä¾‹ã§ã‚‚ç™ºå‹•ã™ã‚‹ã¯ãšã§ã™ (document.write()ä½¿ç”¨)ã€‚ç™ºå‹•ã—ãªã„å ´åˆã¯ã€2ç•ªç›®ã®ä¾‹ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚<br>
            â€» ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ä¸Šã®ãƒ•ã‚©ãƒ¼ãƒ ã«è²¼ã‚Šä»˜ã‘ã¦é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
        </p>
    </div>
    
    <hr>
    
    <h3>åå°„çµæœ:</h3>

    <script>
        // 1. URLã‹ã‚‰ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ 'q' ã®å€¤ã‚’å–å¾—
        const params = new URLSearchParams(window.location.search);
        const query = params.get('q');
        
        if (query) {
            const decodedQuery = decodeURIComponent(query.replace(/\+/g, ' '));
            
            // â˜… æœ€ã‚‚ç´ ç›´ã§ç¢ºå®Ÿãªè„†å¼±æ€§ã‚³ãƒ¼ãƒ‰ (document.write) â˜…
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’HTMLã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å¼·åˆ¶çš„ã«æ›¸ãè¾¼ã‚€
            document.write('ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›: ' + decodedQuery);
            
            // NOTE: document.write() ã®å¾Œã§ãƒšãƒ¼ã‚¸ã®å†…å®¹ãŒã™ã¹ã¦ç½®ãæ›ã‚ã‚‹ãŸã‚ã€
            // ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆä»¥é™ã®HTMLã¯é€šå¸¸ã€è¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚
        }
    </script>
</body>
</html>
